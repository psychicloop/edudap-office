{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Quotations</h2>
    </div>

    <div class="card p-4 mb-4">
        <form action="{{ url_for('quotations.upload') }}" method="post" enctype="multipart/form-data" class="row g-3 align-items-end">
            <div class="col-md-9">
                <label for="file" class="form-label">Upload Excel/PDF</label>
                <input type="file" name="file" class="form-control" required>
            </div>
            <div class="col-md-3">
                <button type="submit" class="btn btn-primary w-100">
                    <i class="bi bi-cloud-upload"></i> Upload
                </button>
            </div>
        </form>
    </div>

    <div class="mb-3">
        <input type="text" id="searchInput" class="form-control" placeholder="Search files...">
    </div>

    <div class="list-group" id="filesList">
        {% for q in quotations %}
        <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
            <div>
                <i class="bi bi-file-earmark-text me-2 text-primary"></i>
                {{ q.filename }}
                <br>
                <small class="text-muted">Uploaded by {{ q.uploader.username }} on {{ q.uploaded_at.strftime('%Y-%m-%d') }}</small>
            </div>
            <i class="bi bi-download text-secondary"></i>
        </a>
        {% endfor %}
    </div>
</div>

<script>
document.getElementById('searchInput').addEventListener('keyup', function() {
    let filter = this.value.toLowerCase();
    let items = document.querySelectorAll('#filesList a');
    items.forEach(function(item) {
        let text = item.textContent.toLowerCase();
        item.style.display = text.includes(filter) ? '' : 'none';
    });
});
</script>
{% endblock %}
