<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>My Expenses</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/theme.css') }}">
  <style>
    /* Minimal inline fallback */
    :root { color-scheme: light dark; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin:0; background:#f7f7fb; color:#222; }
    
    header.app-header { display:flex; align-items:center; gap:.75rem; padding:1rem; background:#0f62fe; color:white; }
    header.app-header .logo { width:28px; height:28px; object-fit:contain; }
    
    main.container { padding: 1rem 1.25rem; max-width: 1000px; margin: 0 auto; }
    h1 { font-size: 1.25rem; margin: 0; }
    
    .card { background:white; border-radius:10px; padding:1.5rem; box-shadow: 0 1px 2px rgba(0,0,0,.08); margin-bottom: 2rem; }
    
    /* FORM STYLES */
    .form-group { margin-bottom: 1rem; }
    label { display: block; margin-bottom: .5rem; font-weight: 500; font-size: 0.9rem; }
    input, select, textarea { width: 100%; padding: .6rem; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; box-sizing: border-box; }
    button.btn-primary { background: #0f62fe; color: white; border: none; padding: .75rem 1.5rem; border-radius: 4px; cursor: pointer; font-size: 1rem; font-weight: 500; }
    button.btn-primary:hover { background: #0353e9; }

    /* TABLE STYLES */
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { padding: .75rem .5rem; border-bottom: 1px solid #eee; text-align:left; }
    th { font-size:.85rem; color:#555; background:#fafafa; text-transform: uppercase; letter-spacing: 0.5px; }
    .muted { color:#666; }
    
    .status { font-size:.75rem; padding: .25rem .5rem; border-radius:.5rem; display:inline-block; font-weight: 600; }
    .status.SUBMITTED { background:#e8f0fe; color:#1a73e8; }
    .status.APPROVED  { background:#e6f4ea; color:#137333; }
    .status.REJECTED  { background:#fce8e6; color:#c5221f; }
    
    .empty { padding: 2rem; color: #666; text-align: center; font-style: italic; }
  </style>
</head>
<body>

<header class="app-header">
  <img src="{{ url_for('static', filename='img/logo-icon.png') }}" alt="Logo" class="logo">
  <h1>Expenses</h1>
</header>

<main class="container">

  <div class="card">
    <h2 style="margin-top:0; margin-bottom: 1rem; font-size: 1.2rem;">Add New Expense</h2>
    
    <form action="{{ url_for('expenses.submit_expense') }}" method="POST" enctype="multipart/form-data">
      
      <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
        <div style="flex: 1;">
          <label>Amount</label>
          <input type="number" step="0.01" name="amount" placeholder="0.00" required>
        </div>
        <div style="width: 100px;">
          <label>Currency</label>
          <select name="currency">
            <option value="INR">INR</option>
            <option value="USD">USD</option>
            <option value="EUR">EUR</option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <label>Category</label>
        <select name="category" required>
          <option value="Travel">Travel</option>
          <option value="Food">Food</option>
          <option value="Office Supplies">Office Supplies</option>
          <option value="Client Meeting">Client Meeting</option>
          <option value="Other">Other</option>
        </select>
      </div>

      <div class="form-group">
        <label>Description / Notes</label>
        <textarea name="caption" rows="2" placeholder="What was this for?"></textarea>
      </div>

      <div class="form-group">
        <label>Receipt (Optional)</label>
        <input type="file" name="attachment">
      </div>

      <button type="submit" class="btn-primary">Submit Expense</button>
    </form>
  </div>

  <div class="card">
    <h2 style="margin-top:0; margin-bottom: 0.5rem; font-size: 1.2rem;">My History</h2>
    
    {% if records and records|length > 0 %}
      <table aria-label="Expense records">
        <thead>
          <tr>
            <th>Date</th>
            <th>Category</th>
            <th>Amount</th>
            <th>Notes</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for r in records %}
          <tr>
            <td>{{ r.submitted_at.strftime('%Y-%m-%d') if r.submitted_at else 'Just now' }}</td>
            <td><strong>{{ r.category or '-' }}</strong></td>
            <td>{{ "%.2f"|format(r.amount or 0) }} {{ r.currency }}</td>
            <td class="muted">{{ r.caption or '-' }}</td>
            <td><span class="status {{ r.status }}">{{ r.status }}</span></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <div class="empty">No expenses yet. Use the form above to add one!</div>
    {% endif %}
  </div>

</main>

</body>
</html>
