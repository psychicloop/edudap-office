{% extends "base.html" %}
{% block content %}
<div class="row mb-4">
    <div class="col-md-6"><h4 class="fw-bold">Expense Management</h4></div>
    <div class="col-md-6 text-end">
        <a href="{{ url_for('admin.export_expenses') }}" class="btn btn-outline-success"><i class="bi bi-download me-2"></i>Export Report</a>
    </div>
</div>

<div class="row g-3 mb-4">
    <div class="col-md-6"><div class="card bg-success text-white border-0 shadow-sm"><div class="card-body"><h3>₹{{ stats.approved }}</h3><p class="mb-0">Total Approved</p></div></div></div>
    <div class="col-md-6"><div class="card bg-warning text-dark border-0 shadow-sm"><div class="card-body"><h3>₹{{ stats.pending }}</h3><p class="mb-0">Pending Approval</p></div></div></div>
</div>

<ul class="nav nav-tabs mb-3"><li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#pending">Pending</button></li><li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#history">History</button></li></ul>
<div class="tab-content">
    <div class="tab-pane fade show active" id="pending">
        <div class="card border-0 shadow-sm"><table class="table mb-0 align-middle"><tbody>{% for exp in pending %}<tr><td class="ps-4 fw-bold">{{ exp.user.username }}</td><td>₹{{ exp.amount }}<br><small class="text-muted">{{ exp.category }}</small></td><td>{% if exp.bill_image %}<a href="{{ url_for('static', filename='uploads/'+exp.bill_image) }}" target="_blank" class="btn btn-sm btn-outline-primary">Bill</a>{% endif %}</td><td class="text-end pe-4"><a href="{{ url_for('admin.approve_expense', id=exp.id) }}" class="btn btn-success btn-sm">Yes</a> <a href="{{ url_for('admin.reject_expense', id=exp.id) }}" class="btn btn-danger btn-sm">No</a></td></tr>{% endfor %}</tbody></table></div>
    </div>
    <div class="tab-pane fade" id="history">
        <div class="card border-0 shadow-sm"><table class="table mb-0 align-middle text-muted"><tbody>{% for exp in history %}<tr><td class="ps-4">{{ exp.user.username }}</td><td>₹{{ exp.amount }}</td><td><span class="badge {{ 'bg-success' if exp.status=='Approved' else 'bg-danger' }}">{{ exp.status }}</span></td></tr>{% endfor %}</tbody></table></div>
    </div>
</div>
{% endblock %}
